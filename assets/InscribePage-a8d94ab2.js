import{_ as ae,x as G,y as B,i as A,j as V,k as W,z as me,B as ce,D as de,m as F,u as he,G as R,C as M,g as fe,r as x,o as n,c as m,b as s,f as l,q as a,s as g,t as f,E as b,e as w,H as ue,I as pe}from"./index-4be3c9c9.js";import{m as N,S as O,C as j,P as J,W as K,O as q,A as Y,D as Z,G as X,B as Q,V as E}from"./OrbitControls-77b6d84d.js";import{f as ge,I as D}from"./inscription-bbf09319.js";import{k as U,o as xe,p as Fe,j as we,q as $,r as ee,s as ie}from"./helpers-a77e3aae.js";import{M as L}from"./abi-cde10b30.js";const _e={name:"InscribePage",components:{InfoFilled:G,Upload:B,Headset:A,FolderOpened:V,Box:W,SuccessFilled:me,Link:ce,DocumentCopy:de},data(){return{Upload:F(B),InfoFilled:F(G),Headset:F(A),FolderOpened:F(V),Box:F(W),activeTab:"text",inscribing:!1,currentGasPrice:null,userDataError:!1,textForm:{content:""},fileForm:{file:null,preview:null,mimeType:"",userData:""},fileGasEstimate:null,fixForm:{itemId:"",curDealingItemId:"",loading:!1,itemInfo:null,isComplete:!1,file:null,preview:null,mimeType:"",validationStatus:null,gasEstimate:null,estimatedTxs:0,fileData:null,mineFlag:0,txCounter:0},uploadState:{isUploading:!1,isPaused:!1,currentTx:0,totalTxs:0,resumeData:null},inscribeResult:{visible:!1,txHash:""},threeScene:null,threeRenderer:null,threeCamera:null,threeControls:null,fixThreeScene:null,fixThreeRenderer:null,fixThreeCamera:null,fixThreeControls:null}},computed:{walletStore(){return he()},markdownPreview(){return!this.fileForm.preview||this.fileForm.mimeType!=="text/markdown"?"":N(this.fileForm.preview)},fixMarkdownPreview(){return!this.fixForm.preview||this.fixForm.mimeType!=="text/markdown"?"":N(this.fixForm.preview)},isImageFile(){return this.fileForm.mimeType&&this.fileForm.mimeType.startsWith("image/")&&this.fileForm.mimeType!=="image/svg+xml"},isFixImageFile(){return this.fixForm.mimeType&&this.fixForm.mimeType.startsWith("image/")&&this.fixForm.mimeType!=="image/svg+xml"},is3DModel(){return U(this.fileForm.mimeType)},isFixModel(){return U(this.fixForm.mimeType)},uploadProgressPercentage(){return this.uploadState.totalTxs===0?0:Math.round(this.uploadState.currentTx/this.uploadState.totalTxs*100)}},beforeUnmount(){this.cleanupThreeJs(),this.cleanupFixThreeJs()},methods:{formatBytes:xe,getExplorerUrl:Fe,isArchive(t){return we(t)},limitUtf8Bytes(){new TextEncoder().encode(this.fileForm.userData).length>32?this.userDataError=!0:this.userDataError=!1},cleanupThreeJs(){this.threeRenderer&&(this.threeRenderer.domElement&&this.threeRenderer.domElement.parentNode&&this.threeRenderer.domElement.parentNode.removeChild(this.threeRenderer.domElement),this.threeRenderer.dispose(),this.threeRenderer=null),this.threeControls&&(this.threeControls.dispose(),this.threeControls=null),this.threeScene&&(this.threeScene.traverse(i=>{i.geometry&&i.geometry.dispose(),i.material&&(Array.isArray(i.material)?i.material.forEach(o=>o.dispose()):i.material.dispose())}),this.threeScene=null),this.threeCamera=null;const t=this.$refs.modelContainer;if(t)for(;t.firstChild;)t.removeChild(t.firstChild)},cleanupFixThreeJs(){this.fixThreeRenderer&&(this.fixThreeRenderer.domElement&&this.fixThreeRenderer.domElement.parentNode&&this.fixThreeRenderer.domElement.parentNode.removeChild(this.fixThreeRenderer.domElement),this.fixThreeRenderer.dispose(),this.fixThreeRenderer=null),this.fixThreeControls&&(this.fixThreeControls.dispose(),this.fixThreeControls=null),this.fixThreeScene&&(this.fixThreeScene.traverse(i=>{i.geometry&&i.geometry.dispose(),i.material&&(Array.isArray(i.material)?i.material.forEach(o=>o.dispose()):i.material.dispose())}),this.fixThreeScene=null),this.fixThreeCamera=null;const t=this.$refs.fixModelContainer;if(t)for(;t.firstChild;)t.removeChild(t.firstChild)},async load3DModel(t){this.cleanupThreeJs(),await this.$nextTick();const i=this.$refs.modelContainer;if(!i){console.error("Model container not found");return}this.threeScene=F(new O),this.threeScene.background=new j(15790320);const o=i.clientWidth,c=i.clientHeight;this.threeCamera=F(new J(75,o/c,.1,1e3)),this.threeCamera.position.set(2,2,2),this.threeRenderer=F(new K({antialias:!0})),this.threeRenderer.setSize(o,c),this.threeRenderer.setPixelRatio(window.devicePixelRatio),i.appendChild(this.threeRenderer.domElement),this.threeControls=F(new q(this.threeCamera,this.threeRenderer.domElement)),this.threeControls.enableDamping=!0,this.threeControls.dampingFactor=.05;const e=F(new Y(16777215,.6));this.threeScene.add(e);const r=F(new Z(16777215,.8));r.position.set(1,1,1),this.threeScene.add(r);const u=new X,h=URL.createObjectURL(t);u.load(h,d=>{const p=F(d.scene),y=new Q().setFromObject(p),S=y.getCenter(new E),C=y.getSize(new E);p.position.sub(S);const _=Math.max(C.x,C.y,C.z),I=this.threeCamera.fov*(Math.PI/180);let v=Math.abs(_/2/Math.tan(I/2));v*=1.5,this.threeCamera.position.set(v,v*.5,v),this.threeCamera.lookAt(0,0,0),this.threeControls.target.set(0,0,0),this.threeControls.update(),this.threeScene.add(p);const k=()=>{!this.threeRenderer||!this.threeScene||!this.threeCamera||(requestAnimationFrame(k),this.threeControls.update(),this.threeRenderer.render(this.threeScene,this.threeCamera))};k(),URL.revokeObjectURL(h)},d=>{const p=d.loaded/d.total*100;console.log(`Loading: ${p.toFixed(2)}%`)},d=>{console.error("Error loading GLB:",d),URL.revokeObjectURL(h),this.$message.error("Failed to load 3D model")})},async loadFix3DModel(t){this.cleanupFixThreeJs(),await this.$nextTick();const i=this.$refs.fixModelContainer;if(!i){console.error("Fix model container not found");return}this.fixThreeScene=F(new O),this.fixThreeScene.background=new j(15790320);const o=i.clientWidth,c=i.clientHeight;this.fixThreeCamera=F(new J(75,o/c,.1,1e3)),this.fixThreeCamera.position.set(2,2,2),this.fixThreeRenderer=F(new K({antialias:!0})),this.fixThreeRenderer.setSize(o,c),this.fixThreeRenderer.setPixelRatio(window.devicePixelRatio),i.appendChild(this.fixThreeRenderer.domElement),this.fixThreeControls=F(new q(this.fixThreeCamera,this.fixThreeRenderer.domElement)),this.fixThreeControls.enableDamping=!0,this.fixThreeControls.dampingFactor=.05;const e=F(new Y(16777215,.6));this.fixThreeScene.add(e);const r=F(new Z(16777215,.8));r.position.set(1,1,1),this.fixThreeScene.add(r);const u=new X,h=URL.createObjectURL(t);u.load(h,d=>{const p=F(d.scene),y=new Q().setFromObject(p),S=y.getCenter(new E),C=y.getSize(new E);p.position.sub(S);const _=Math.max(C.x,C.y,C.z),I=this.fixThreeCamera.fov*(Math.PI/180);let v=Math.abs(_/2/Math.tan(I/2));v*=1.5,this.fixThreeCamera.position.set(v,v*.5,v),this.fixThreeCamera.lookAt(0,0,0),this.fixThreeControls.target.set(0,0,0),this.fixThreeControls.update(),this.fixThreeScene.add(p);const k=()=>{!this.fixThreeRenderer||!this.fixThreeScene||!this.fixThreeCamera||(requestAnimationFrame(k),this.fixThreeControls.update(),this.fixThreeRenderer.render(this.fixThreeScene,this.fixThreeCamera))};k(),URL.revokeObjectURL(h)},d=>{const p=d.loaded/d.total*100;console.log(`Loading: ${p.toFixed(2)}%`)},d=>{console.error("Error loading GLB:",d),URL.revokeObjectURL(h),this.$message.error("Failed to load 3D model")})},async fetchGasPrice(){const t=Date.now();if(window.lastGasFetchTime&&t-window.lastGasFetchTime<R.kPullGasPriceCd)return this.currentGasPrice=window.lastGasPrice,this.currentGasPrice;try{const o=await M.getProvider().send("eth_gasPrice",[]),c=BigInt(o),e=parseFloat(ge(c,"gwei"));return this.currentGasPrice=e,window.lastGasFetchTime=t,window.lastGasPrice=e,e}catch(i){return console.error("Failed to fetch gas price:",i),1}},async handleFileChange(t){this.cleanupThreeJs(),this.fileForm.file=t.raw,this.fileForm.mimeType=$(t.name),this.fileForm.userData=t.name.length<=32?t.name:t.name.substring(0,32),this.fileForm.preview=null;const i=new FileReader;this.fileForm.mimeType==="image/svg+xml"||this.fileForm.mimeType==="text/html"||this.fileForm.mimeType==="text/markdown"?(i.onload=c=>{this.fileForm.preview=c.target.result},i.readAsText(t.raw)):this.isImageFile||this.fileForm.mimeType.startsWith("audio/")||this.fileForm.mimeType.startsWith("video/")||this.fileForm.mimeType==="application/pdf"?(i.onload=c=>{this.fileForm.preview=c.target.result},i.readAsDataURL(t.raw)):U(this.fileForm.mimeType)?(this.fileForm.preview="model",await this.$nextTick(),this.load3DModel(t.raw)):this.fileForm.preview="file-icon";const o=await this.fetchGasPrice();this.fileGasEstimate=ee(t.raw.size,o)},async loadIncompleteItem(){if(!this.fixForm.itemId){this.$message.warning("Please enter an inscription ID");return}if(!parseInt(this.fixForm.itemId)){this.$message.error("Invalid inscription ID");return}this.fixForm.loading=!0;try{const t=M.getProvider(),i=new D(t),o=await i.getItem(this.fixForm.itemId);if(!o||o.dataType.length==0){this.$message.error(`Inscription #${this.fixForm.itemId} not found`),this.fixForm.loading=!1;return}this.fixForm.curDealingItemId=this.fixForm.itemId;const c=o.inlineData&&o.inlineData!=="0x"&&o.dataHolders.length===0;let e=0;if(!c){const d=await i.getBigDataChunkCount(this.fixForm.itemId);d>0?e=d:e=o.dataHolders.length}const r=o.dataHolders.length,u=e-r,h=c||e>0&&r>=e;if(this.fixForm.itemInfo={userData:o.userData,dataType:o.dataType,totalChunks:e,currentChunks:r,missingChunks:u,dataHolders:o.dataHolders,contentSize:o.contentSize,txCounter:0},!h){this.fixForm.mineFlag=1;const d=await i.ownerOf(this.fixForm.itemId);this.fixForm.mineFlag=R.isAddressEqual(d,this.walletStore.account)?2:3}this.fixForm.isComplete=h}catch(t){console.error("Failed to load item:",t),this.$message.error("Failed to load inscription info")}finally{this.fixForm.loading=!1}},async handleFixFileChange(t){this.cleanupFixThreeJs(),this.fixForm.file=t.raw,this.fixForm.mimeType=$(t.name),this.fixForm.preview=null,this.fixForm.validationStatus=null,this.fixForm.gasEstimate=null;const i=new FileReader;this.fixForm.mimeType==="image/svg+xml"||this.fixForm.mimeType==="text/html"||this.fixForm.mimeType==="text/markdown"?(i.onload=o=>{this.fixForm.preview=o.target.result},i.readAsText(t.raw)):this.isFixImageFile||this.fixForm.mimeType.startsWith("audio/")||this.fixForm.mimeType.startsWith("video/")||this.fixForm.mimeType==="application/pdf"?(i.onload=o=>{this.fixForm.preview=o.target.result},i.readAsDataURL(t.raw)):U(this.fixForm.mimeType)?(this.fixForm.preview="model",await this.$nextTick(),this.loadFix3DModel(t.raw)):this.fixForm.preview="file-icon",await this.validateFixFile()},async validateFixFile(){if(!(!this.fixForm.file||!this.fixForm.itemInfo)){this.fixForm.validationStatus="validating";try{const t=await ie(this.fixForm.file);this.fixForm.fileData=t;const i=Math.min(L,t.length),o=t.slice(0,i),c=M.getProvider(),e=new D(c),r=this.fixForm.itemInfo.dataHolders[0],u=await e.readAddressCodes([r]);if(!u||u.length===0){this.fixForm.validationStatus="mismatch",this.$message.error("Failed to read inscription data");return}const h=new Uint8Array(fe(u[0]));let d=!0;if(i!=L||i!=h.length)d=!1;else for(let p=0;p<L;p++)if(o[p]!==h[p]){d=!1;break}if(d){if(this.fixForm.validationStatus="match",this.walletStore.isConnected){const p=this.fixForm.itemInfo.contentSize-this.fixForm.itemInfo.currentChunks*L,y=await this.fetchGasPrice();this.fixForm.gasEstimate=ee(p,y),this.fixForm.estimatedTxs=Math.ceil(this.fixForm.itemInfo.missingChunks/4)}}else this.fixForm.validationStatus="mismatch"}catch(t){console.error("Validation error:",t),this.fixForm.validationStatus="mismatch",this.$message.error("Validation failed")}}},async continueIncompleteInscription(){if(!this.walletStore.signer){this.$message.warning("Please connect your wallet first");return}if(this.fixForm.validationStatus!=="match"){this.$message.error("File validation failed");return}this.inscribing=!0;try{const t=new D(this.walletStore.signer),i=Math.ceil(this.fixForm.itemInfo.currentChunks/4);R.markCurInscribingBigDataInscriptionId(parseInt(this.fixForm.curDealingItemId));let o=this;const c=await t.inscribeData(this.fixForm.itemInfo.dataType,this.fixForm.fileData,this.fixForm.itemInfo.userData,this.walletStore.account,i+this.fixForm.txCounter,i,(r,u)=>{o.fixForm.txCounter++,console.log(`Progress: ${r-i}/${u-i}`)});if(this.fixForm={itemId:"",loading:!1,itemInfo:null,file:null,preview:null,mimeType:"",validationStatus:null,gasEstimate:null,estimatedTxs:0,fileData:null,mineFlag:0,txCounter:0},!c)return;const e=(c==null?void 0:c.hash)||c;this.inscribeResult.txHash=e,this.inscribeResult.visible=!0,this.waitForMinting(e)}catch(t){console.error("Failed to continue inscription:",t),t.code===4001||t.message.includes("user rejected")?this.$message.warning("Upload canceled."):this.$message.error(t.message||"Failed to continue inscription")}finally{this.inscribing=!1}},async inscribeText(){if(!this.walletStore.signer){this.$message.warning("Please connect your wallet first");return}this.textForm.content=this.textForm.content.trim();const t=new TextEncoder().encode(this.textForm.content);if(t.length===0||t.length>95*1024){this.$message.error("Text must be between 1 byte and 95KB");return}this.inscribing=!0;let i;try{const o=new D(this.walletStore.signer);if(t.length<=128){const e=await o.findFirstInlines([this.textForm.content]);if(e[0]!=0&&!await this.$confirm(`This text first appeared in inscription #${e[0]}. Do you still want to inscribe it?`,"Confirm Inscribe",{confirmButtonText:"Yes",cancelButtonText:"No",type:"warning"}).catch(()=>!1))return;i=await o.inscribeInline(this.textForm.content,this.walletStore.account)}else i=await o.inscribeData("text/plain",t,"",this.walletStore.account,0,0);if(this.textForm.content="",!i)return;const c=(i==null?void 0:i.hash)||i;this.inscribeResult.txHash=c,this.inscribeResult.visible=!0,this.waitForMinting(c)}catch(o){console.error("Failed to inscribe text:",o),o.code===4001||o.message.includes("user rejected")?this.$message.warning("Upload canceled."):this.$message.error(o.message||"Failed to inscribe text")}finally{this.inscribing=!1}},async waitForMinting(t){try{const i=M.getProvider();if(!i)return;const o=await i.waitForTransaction(t,1);if(o&&o.status===1){this.inscribeResult.visible&&this.inscribeResult.txHash===t&&(this.inscribeResult.visible=!1);let c=null;if(o.logs&&o.logs.length>=2){const r=o.logs[1];if(r.topics&&r.topics.length>=2){const u=r.topics[1];c=BigInt(u).toString(),console.log("Inscription minted with itemId:",c)}}else c=R.GetCurInscribingBigDataInscriptionId();const e=c?`ðŸŽ‰ Inscription #${c} inscribed successfully!`:"ðŸŽ‰ Inscription inscribed successfully!";this.$message({message:e,type:"success",duration:5e3,showClose:!0})}}catch(i){console.error("Failed to wait for transaction:",i)}},async inscribeFile(){if(!this.walletStore.signer){this.$message.warning("Please connect your wallet first");return}if(!this.fileForm.file){this.$message.error("Please select a file");return}try{const t=await ie(this.fileForm.file),i=new D(this.walletStore.signer),o=[];for(let u=0;u<t.length;u+=24320)o.push(t.slice(u,u+24320));const c=Math.ceil(o.length/4);this.inscribing=!0,this.uploadState={isUploading:!0,isPaused:!1,currentTx:0,totalTxs:c,resumeData:{dataType:this.fileForm.mimeType,fileData:t,userData:this.fileForm.userData}};let e=await i.inscribeData(this.fileForm.mimeType,t,this.fileForm.userData,this.walletStore.account,0,0,(u,h)=>{this.uploadState.currentTx=u,this.uploadState.totalTxs=h});if(this.fileForm={file:null,preview:null,mimeType:"",userData:""},this.uploadState={isUploading:!1,isPaused:!1,currentTx:0,totalTxs:0,resumeData:null},!e){this.uploadState.isUploading=!1;return}const r=(e==null?void 0:e.hash)||e;this.inscribeResult.txHash=r,this.inscribeResult.visible=!0,this.waitForMinting(r)}catch(t){console.error("Failed to inscribe file:",t),t.code===4001||t.message.includes("user rejected")?(this.uploadState.isPaused=!0,this.uploadState.isUploading=!1,this.$message.warning('Upload paused. Click "Continue Inscribe" to resume.')):(this.uploadState.isPaused=!0,this.uploadState.isUploading=!1,this.$message.error(t.message||"Failed to inscribe file"))}finally{this.inscribing=!1}},async continueUpload(){if(!this.uploadState.resumeData){this.$message.error("No upload data to resume");return}try{const t=new D(this.walletStore.signer);this.uploadState.currentTx==0,this.inscribing=!0,this.uploadState.isPaused=!1,this.uploadState.isUploading=!0;const{dataType:i,fileData:o,userData:c}=this.uploadState.resumeData,e=await t.inscribeData(i,o,c,this.walletStore.account,this.uploadState.currentTx,0,(u,h)=>{this.uploadState.currentTx=u,this.uploadState.totalTxs=h});if(this.fileForm={file:null,preview:null,mimeType:"",userData:""},this.uploadState={isUploading:!1,isPaused:!1,currentTx:0,totalTxs:0,resumeData:null},!e)return;const r=(e==null?void 0:e.hash)||e;this.inscribeResult.txHash=r,this.inscribeResult.visible=!0,this.waitForMinting(r)}catch(t){console.error("Failed to continue upload:",t),t.code===4001||t.message.includes("user rejected")?(this.uploadState.isPaused=!0,this.uploadState.isUploading=!1,this.$message.warning("Upload paused again.")):(this.uploadState.isPaused=!0,this.uploadState.isUploading=!1,this.$message.error(t.message||"Failed to continue upload"))}finally{this.inscribing=!1}},resetTextForm(){this.textForm={content:""}},resetFileForm(){this.cleanupThreeJs(),this.fileForm={file:null,preview:null,mimeType:"",userData:""},this.fileGasEstimate=null,this.uploadState={isUploading:!1,isPaused:!1,currentTx:0,totalTxs:0,resumeData:null},this.userDataError=!1},resetFixForm(){this.cleanupFixThreeJs(),this.fixForm={itemId:"",curDealingItemId:"",loading:!1,itemInfo:null,isComplete:!1,file:null,preview:null,mimeType:"",validationStatus:null,gasEstimate:null,estimatedTxs:0,fileData:null,mineFlag:0,txCounter:0}},handleTabChange(t){t==="text"?this.resetTextForm():t==="file"?this.resetFileForm():t==="fix"&&this.resetFixForm()}}},ve={class:"page-container"},ye={key:0},Te={key:1},be={class:"info-text"},Ce={key:0,class:"file-info"},ke={class:"file-details"},Se={key:0,class:"file-preview"},Ie={key:0,class:"image-preview"},De=["src"],Pe=["innerHTML"],Re={key:2,class:"markdown-preview"},Me=["innerHTML"],Ee={key:3,class:"html-preview"},Ue=["srcdoc"],Le={key:4,class:"media-preview"},He=["src"],ze={key:5,class:"media-preview"},Ge=["src"],Be={key:6,class:"pdf-preview"},Ae=["src"],Ve={key:7,class:"model-preview"},We={ref:"modelContainer",class:"model-viewer"},Ne={key:8,class:"file-icon-preview"},Oe={key:0,style:{color:"red","font-size":"12px"}},je={key:0,class:"gas-estimate"},Je={class:"gas-detail"},Ke={key:1,class:"upload-progress"},qe={class:"progress-text"},Ye={key:0},Ze={key:1},Xe={key:0,class:"login-prompt"},Qe={class:"login-prompt-content"},$e={key:0,class:"item-info"},ei={class:"info-header"},ii={key:0,class:"complete-notice"},ti={class:"info-content"},si={class:"info-row"},oi={class:"value"},ri={class:"info-row"},ni={class:"value"},li={class:"info-row"},ai={class:"value"},mi={class:"info-row"},ci={class:"value"},di={key:0,class:"info-row"},hi={class:"value missing"},fi={key:2,class:"file-info fix-file-info"},ui={class:"file-details"},pi={key:0,class:"validation-status"},gi={key:0},xi={key:1},Fi={key:2},wi={key:1,class:"file-preview fix-preview"},_i={key:0,class:"image-preview"},vi=["src"],yi=["innerHTML"],Ti={key:2,class:"markdown-preview"},bi=["innerHTML"],Ci={key:3,class:"html-preview"},ki=["srcdoc"],Si={key:4,class:"media-preview"},Ii=["src"],Di={key:5,class:"media-preview"},Pi=["src"],Ri={key:6,class:"pdf-preview"},Mi=["src"],Ei={key:7,class:"model-preview"},Ui={ref:"fixModelContainer",class:"model-viewer fix-model-viewer"},Li={key:8,class:"file-icon-preview"},Hi={key:0,class:"gas-estimate"},zi={class:"gas-detail"},Gi={key:0},Bi={key:1},Ai={class:"dialog-header"},Vi={class:"success-icon"},Wi={class:"dialog-title"},Ni={class:"dialog-body"},Oi={class:"success-message"},ji={class:"tx-info"},Ji=["href"],Ki={class:"dialog-footer"};function qi(t,i,o,c,e,r){const u=x("el-input"),h=x("el-form-item"),d=x("el-button"),p=x("el-form"),y=x("el-tab-pane"),S=x("el-upload"),C=x("InfoFilled"),_=x("el-icon"),I=x("Headset"),v=x("FolderOpened"),k=x("Box"),H=x("el-card"),te=x("el-progress"),z=x("el-space"),P=x("el-alert"),se=x("DocumentCopy"),oe=x("el-tabs"),re=x("SuccessFilled"),ne=x("Link"),le=x("el-dialog");return n(),m("div",ve,[i[35]||(i[35]=s("h1",{class:"page-title"},"Inscribe",-1)),l(oe,{modelValue:e.activeTab,"onUpdate:modelValue":i[5]||(i[5]=T=>e.activeTab=T),class:"inscribe-tabs",onTabChange:r.handleTabChange},{default:a(()=>[l(y,{label:"Text",name:"text"},{default:a(()=>[l(p,{model:e.textForm,"label-position":"top"},{default:a(()=>[l(h,{label:"Text Content"},{default:a(()=>[l(u,{modelValue:e.textForm.content,"onUpdate:modelValue":i[0]||(i[0]=T=>e.textForm.content=T),type:"textarea",rows:12,placeholder:"Enter your text here (max 95KB)",maxlength:95*1024},null,8,["modelValue"])]),_:1}),l(h,null,{default:a(()=>[l(d,{type:"primary",size:"large",loading:e.inscribing,disabled:!e.textForm.content||!r.walletStore.isConnected,onClick:r.inscribeText},{default:a(()=>[e.inscribing?(n(),m("span",Te,"Inscribing...")):(n(),m("span",ye,"Inscribe (Burn 0.0001 ETH)"))]),_:1},8,["loading","disabled","onClick"])]),_:1})]),_:1},8,["model"])]),_:1}),l(y,{label:"File",name:"file"},{default:a(()=>[l(p,{model:e.fileForm,"label-position":"top"},{default:a(()=>[l(h,null,{default:a(()=>[l(S,{ref:"fileUpload","auto-upload":!1,"show-file-list":!1,"on-change":r.handleFileChange,accept:"image/*,.svg,.md,.markdown,.html,.mp3,.wav,.ogg,.mp4,.webm,.zip,.rar,.7z,.glb,.gltf,.pdf"},{default:a(()=>[l(d,{type:"primary",icon:e.Upload,disabled:e.uploadState.isPaused},{default:a(()=>[...i[8]||(i[8]=[g("Browse File",-1)])]),_:1},8,["icon","disabled"])]),_:1},8,["on-change"])]),_:1}),l(h,null,{default:a(()=>[s("div",be,[l(_,null,{default:a(()=>[l(C)]),_:1}),i[9]||(i[9]=g(" Supported: Images, SVG, PDF, HTML, Markdown, Audio, Video, Archive, 3D Model (glb, gltf). Suggest compressing image using ",-1)),i[10]||(i[10]=s("a",{href:"https://tinypng.com",target:"_blank"},"TinyPNG",-1)),i[11]||(i[11]=g(". Suggest using Metamask. ",-1))])]),_:1}),e.fileForm.file?(n(),m("div",Ce,[l(H,null,{default:a(()=>[s("div",ke,[s("div",null,[i[12]||(i[12]=s("strong",null,"File:",-1)),g(" "+f(e.fileForm.file.name),1)]),s("div",null,[i[13]||(i[13]=s("strong",null,"Size:",-1)),g(" "+f(r.formatBytes(e.fileForm.file.size)),1)]),s("div",null,[i[14]||(i[14]=s("strong",null,"Type:",-1)),g(" "+f(e.fileForm.mimeType),1)])]),e.fileForm.preview?(n(),m("div",Se,[r.isImageFile?(n(),m("div",Ie,[s("img",{src:e.fileForm.preview,alt:"Preview"},null,8,De)])):e.fileForm.mimeType==="image/svg+xml"?(n(),m("div",{key:1,innerHTML:e.fileForm.preview,class:"svg-preview"},null,8,Pe)):e.fileForm.mimeType==="text/markdown"?(n(),m("div",Re,[s("div",{innerHTML:r.markdownPreview,class:"markdown-body"},null,8,Me)])):e.fileForm.mimeType==="text/html"?(n(),m("div",Ee,[s("iframe",{srcdoc:e.fileForm.preview,sandbox:"allow-scripts"},null,8,Ue)])):e.fileForm.mimeType.startsWith("audio/")?(n(),m("div",Le,[l(_,{size:64},{default:a(()=>[l(I)]),_:1}),s("audio",{src:e.fileForm.preview,controls:""},null,8,He)])):e.fileForm.mimeType.startsWith("video/")?(n(),m("div",ze,[s("video",{src:e.fileForm.preview,controls:""},null,8,Ge)])):e.fileForm.mimeType==="application/pdf"?(n(),m("div",Be,[s("iframe",{src:e.fileForm.preview,type:"application/pdf"},null,8,Ae)])):r.is3DModel?(n(),m("div",Ve,[s("div",We,null,512)])):(n(),m("div",Ne,[l(_,{size:64},{default:a(()=>[r.isArchive(e.fileForm.mimeType)?(n(),b(v,{key:0})):(n(),b(k,{key:1}))]),_:1}),s("p",null,f(e.fileForm.file.name),1)]))])):w("",!0)]),_:1})])):w("",!0),l(h,{label:"Optional Note:"},{default:a(()=>[l(u,{modelValue:e.fileForm.userData,"onUpdate:modelValue":i[1]||(i[1]=T=>e.fileForm.userData=T),placeholder:"Enter anything you like, or leave it blank(max 32 bytes)",onInput:r.limitUtf8Bytes,maxlength:32,clearable:""},null,8,["modelValue","onInput"]),e.userDataError?(n(),m("div",Oe," Cannot exceed 32 bytes(UTF-8) ")):w("",!0)]),_:1}),l(h,null,{default:a(()=>[l(z,{direction:"vertical",alignment:"start",style:{width:"100%"}},{default:a(()=>[e.fileGasEstimate&&e.fileForm.file?(n(),m("div",je,[i[16]||(i[16]=g(" Estimate cost: ",-1)),s("span",null,[s("strong",null,f(Math.ceil(e.fileForm.file.size/97280)),1),g(" "+f(Math.ceil(e.fileForm.file.size/97280)>1?"transactions":"transaction")+", total cost ",1),s("strong",null,"< "+f(e.fileGasEstimate.totalCostEth.toFixed(4))+" ETH",1),i[15]||(i[15]=g(".",-1))]),s("span",Je,"(Gas: "+f(e.fileGasEstimate.gasPriceGwei.toFixed(2))+" Gwei)",1)])):w("",!0),e.uploadState.isUploading||e.uploadState.isPaused?(n(),m("div",Ke,[l(te,{percentage:r.uploadProgressPercentage,status:e.uploadState.isPaused?"warning":"success"},null,8,["percentage","status"]),s("div",qe,f(e.uploadState.isPaused?"Paused":"Uploading")+": Transaction "+f(e.uploadState.currentTx)+" / "+f(e.uploadState.totalTxs),1)])):w("",!0),e.uploadState.isPaused?(n(),b(d,{key:3,type:"warning",size:"large",onClick:r.continueUpload},{default:a(()=>[...i[17]||(i[17]=[g(" Continue Inscribe ",-1)])]),_:1},8,["onClick"])):(n(),b(d,{key:2,type:"primary",size:"large",loading:e.inscribing,disabled:!e.fileForm.file||!r.walletStore.isConnected||e.userDataError,onClick:r.inscribeFile},{default:a(()=>[e.inscribing?(n(),m("span",Ze,"Inscribing...")):(n(),m("span",Ye,"Inscribe (Burn 0.0001 ETH)"))]),_:1},8,["loading","disabled","onClick"]))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),l(y,{label:"Fix incomplete inscription",name:"fix"},{default:a(()=>[r.walletStore.isConnected?(n(),b(p,{key:1,model:e.fixForm,"label-position":"top",onSubmit:i[4]||(i[4]=pe(()=>{},["prevent"]))},{default:a(()=>[l(h,{label:"Incomplete Inscription ID"},{default:a(()=>[l(u,{modelValue:e.fixForm.itemId,"onUpdate:modelValue":i[3]||(i[3]=T=>e.fixForm.itemId=T),placeholder:"Enter inscription ID",style:{width:"300px","margin-right":"12px"},clearable:"",onKeyup:ue(r.loadIncompleteItem,["enter","native"])},{append:a(()=>[l(d,{loading:e.fixForm.loading,onClick:r.loadIncompleteItem,disabled:!e.fixForm.itemId},{default:a(()=>[...i[20]||(i[20]=[g(" Load ",-1)])]),_:1},8,["loading","onClick","disabled"])]),_:1},8,["modelValue","onKeyup"])]),_:1}),e.fixForm.itemInfo?(n(),m("div",$e,[l(H,null,{default:a(()=>[s("div",ei,[l(_,{size:24,color:"#67C23A"},{default:a(()=>[l(se)]),_:1}),s("h3",null,"Inscription #"+f(e.fixForm.curDealingItemId),1)]),e.fixForm.isComplete?(n(),m("div",ii,[l(P,{type:"success",closable:!1,"show-icon":""},{title:a(()=>[...i[21]||(i[21]=[g(" This inscription is complete! No fix needed. ",-1)])]),_:1})])):w("",!0),s("div",ti,[s("div",si,[i[22]||(i[22]=s("span",{class:"label"},"User Data:",-1)),s("span",oi,f(e.fixForm.itemInfo.userData||"N/A"),1)]),s("div",ri,[i[23]||(i[23]=s("span",{class:"label"},"Data Type:",-1)),s("span",ni,f(e.fixForm.itemInfo.dataType),1)]),s("div",li,[i[24]||(i[24]=s("span",{class:"label"},"Total Chunks Needed:",-1)),s("span",ai,f(e.fixForm.itemInfo.totalChunks),1)]),s("div",mi,[i[25]||(i[25]=s("span",{class:"label"},"Current Chunks:",-1)),s("span",ci,f(e.fixForm.itemInfo.currentChunks),1)]),e.fixForm.isComplete?w("",!0):(n(),m("div",di,[i[26]||(i[26]=s("span",{class:"label"},"Missing Chunks:",-1)),s("span",hi,f(e.fixForm.itemInfo.missingChunks),1)]))])]),_:1})])):w("",!0),e.fixForm.itemInfo&&!e.fixForm.isComplete&&e.fixForm.mineFlag>1?(n(),b(h,{key:1,label:e.fixForm.mineFlag==2?"Select Matching File":"",style:{"margin-top":"20px"}},{default:a(()=>[e.fixForm.mineFlag==2?(n(),b(S,{key:0,ref:"fixFileUpload","auto-upload":!1,"show-file-list":!1,"on-change":r.handleFixFileChange,accept:"image/*,.svg,.md,.markdown,.html,.mp3,.wav,.ogg,.mp4,.webm,.zip,.rar,.7z,.glb,.gltf,.pdf"},{default:a(()=>[l(d,{type:"primary",icon:e.Upload},{default:a(()=>[...i[27]||(i[27]=[g("Browse original File",-1)])]),_:1},8,["icon"])]),_:1},8,["on-change"])):w("",!0),e.fixForm.mineFlag==3?(n(),b(P,{key:1,type:"warning",closable:!1,"show-icon":""},{title:a(()=>[...i[28]||(i[28]=[s("div",{class:"login-prompt-content"},[s("span",null,"Inscription doesnâ€™t belong to you.")],-1)])]),_:1})):w("",!0)]),_:1},8,["label"])):w("",!0),e.fixForm.file?(n(),m("div",fi,[l(H,null,{default:a(()=>[s("div",ui,[s("div",null,[i[29]||(i[29]=s("strong",null,"File:",-1)),g(" "+f(e.fixForm.file.name),1)]),s("div",null,[i[30]||(i[30]=s("strong",null,"Size:",-1)),g(" "+f(r.formatBytes(e.fixForm.file.size)),1)]),s("div",null,[i[31]||(i[31]=s("strong",null,"Type:",-1)),g(" "+f(e.fixForm.mimeType),1)])]),e.fixForm.validationStatus?(n(),m("div",pi,[l(P,{type:e.fixForm.validationStatus==="match"?"success":e.fixForm.validationStatus==="mismatch"?"error":"info",closable:!1,"show-icon":""},{title:a(()=>[e.fixForm.validationStatus==="match"?(n(),m("span",gi,"âœ… File Matched Successfully!")):e.fixForm.validationStatus==="mismatch"?(n(),m("span",xi," File Does Not Match")):(n(),m("span",Fi,"ðŸ”„ Validating..."))]),_:1},8,["type"])])):w("",!0),e.fixForm.preview?(n(),m("div",wi,[r.isFixImageFile?(n(),m("div",_i,[s("img",{src:e.fixForm.preview,alt:"Preview"},null,8,vi)])):e.fixForm.mimeType==="image/svg+xml"?(n(),m("div",{key:1,innerHTML:e.fixForm.preview,class:"svg-preview"},null,8,yi)):e.fixForm.mimeType==="text/markdown"?(n(),m("div",Ti,[s("div",{innerHTML:r.fixMarkdownPreview,class:"markdown-body"},null,8,bi)])):e.fixForm.mimeType==="text/html"?(n(),m("div",Ci,[s("iframe",{srcdoc:e.fixForm.preview,sandbox:"allow-scripts"},null,8,ki)])):e.fixForm.mimeType.startsWith("audio/")?(n(),m("div",Si,[l(_,{size:48},{default:a(()=>[l(I)]),_:1}),s("audio",{src:e.fixForm.preview,controls:""},null,8,Ii)])):e.fixForm.mimeType.startsWith("video/")?(n(),m("div",Di,[s("video",{src:e.fixForm.preview,controls:""},null,8,Pi)])):e.fixForm.mimeType==="application/pdf"?(n(),m("div",Ri,[s("iframe",{src:e.fixForm.preview,type:"application/pdf"},null,8,Mi)])):r.isFixModel?(n(),m("div",Ei,[s("div",Ui,null,512)])):(n(),m("div",Li,[l(_,{size:48},{default:a(()=>[r.isArchive(e.fixForm.mimeType)?(n(),b(v,{key:0})):(n(),b(k,{key:1}))]),_:1}),s("p",null,f(e.fixForm.file.name),1)]))])):w("",!0)]),_:1})])):w("",!0),e.fixForm.validationStatus==="match"&&r.walletStore.isConnected?(n(),b(h,{key:3},{default:a(()=>[l(z,{direction:"vertical",alignment:"start",style:{width:"100%"}},{default:a(()=>[e.fixForm.gasEstimate?(n(),m("div",Hi,[i[33]||(i[33]=g(" Estimate cost: ",-1)),s("span",null,[s("strong",null,f(e.fixForm.estimatedTxs),1),g(" "+f(e.fixForm.estimatedTxs>1?"transactions":"transaction")+", total cost ",1),s("strong",null,"< "+f(e.fixForm.gasEstimate.totalCostEth.toFixed(4))+" ETH",1),i[32]||(i[32]=g(".",-1))]),s("span",zi,"(Gas: "+f(e.fixForm.gasEstimate.gasPriceGwei.toFixed(2))+" Gwei)",1)])):w("",!0),l(d,{type:"warning",size:"large",loading:e.inscribing,onClick:r.continueIncompleteInscription,class:"highlight-button"},{default:a(()=>[e.inscribing?(n(),m("span",Bi,"Inscribing...")):(n(),m("span",Gi,"Continue Inscribe (No Burn Fee)"))]),_:1},8,["loading","onClick"])]),_:1})]),_:1})):w("",!0)]),_:1},8,["model"])):(n(),m("div",Xe,[l(P,{type:"warning",closable:!1,"show-icon":""},{title:a(()=>[s("div",Qe,[i[19]||(i[19]=s("span",null,"Please connect your wallet to use this feature",-1)),l(d,{type:"primary",size:"small",onClick:i[2]||(i[2]=T=>r.walletStore.connect()),style:{"margin-left":"12px"}},{default:a(()=>[...i[18]||(i[18]=[g(" Connect Wallet ",-1)])]),_:1})])]),_:1})]))]),_:1})]),_:1},8,["modelValue","onTabChange"]),l(le,{modelValue:e.inscribeResult.visible,"onUpdate:modelValue":i[7]||(i[7]=T=>e.inscribeResult.visible=T),width:480,"close-on-click-modal":!0,"align-center":"",class:"success-dialog"},{header:a(()=>[s("div",Ai,[s("div",Vi,[l(_,{size:48,color:"#67C23A"},{default:a(()=>[l(re)]),_:1})]),s("h3",Wi,f(e.uploadState.totalTxs>1?"All transactions":"Transaction")+" Sent!",1)])]),footer:a(()=>[s("div",Ki,[l(d,{type:"primary",size:"large",onClick:i[6]||(i[6]=T=>e.inscribeResult.visible=!1)},{default:a(()=>[...i[34]||(i[34]=[g(" Got it! ",-1)])]),_:1})])]),default:a(()=>[s("div",Ni,[s("p",Oi,f(e.uploadState.totalTxs>1?"Your inscription is on its way! The transactions have been submitted and are waiting for confirmations.":"Your inscription is on its way! The transaction has been submitted and is waiting for confirmation."),1),s("div",ji,[l(_,{class:"link-icon"},{default:a(()=>[l(ne)]),_:1}),s("a",{href:r.getExplorerUrl(e.inscribeResult.txHash,"tx"),target:"_blank",class:"tx-link"}," View Transaction Details ",8,Ji)])])]),_:1},8,["modelValue"])])}const et=ae(_e,[["render",qi],["__scopeId","data-v-f7b39c01"]]);export{et as default};
